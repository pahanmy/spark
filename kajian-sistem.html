<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kajian Keperluan Sistem Kehadiran</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #f1f5f9; }
        
        /* Custom Radio/Checkbox Styles */
        .choice-label {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            background-color: white;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .choice-label:hover {
            background-color: #f8fafc;
            border-color: #94a3b8;
        }
        /* Style bila dipilih */
        input:checked + .choice-label {
            background-color: #eff6ff;
            border-color: #2563eb;
            color: #1e40af;
            box-shadow: 0 0 0 1px #2563eb;
        }
        input:checked + .choice-label .icon-check {
            opacity: 1;
        }
        
        /* Scale 1-5 Style */
        .scale-box input:checked + label {
            background-color: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .section-badge {
            background-color: #1e293b; color: white; 
            padding: 4px 12px; border-radius: 9999px; 
            font-size: 0.7rem; font-weight: 700; letter-spacing: 0.05em;
        }
    </style>
</head>
<body class="text-slate-800">

    <div class="max-w-3xl mx-auto bg-white shadow-2xl min-h-screen border-x border-slate-200">
        
        <div class="bg-gradient-to-r from-slate-900 to-blue-900 p-8 text-white text-center">
            <p class="text-blue-200 text-xs font-bold uppercase tracking-widest mb-2">Peringkat Pra-Pembangunan</p>
            <h1 class="text-3xl font-extrabold uppercase leading-none">Kajian Keperluan Sistem</h1>
            <p class="text-sm mt-3 text-slate-300 max-w-lg mx-auto">Soal selidik ini bertujuan mengenalpasti masalah pengurusan manual dan menentukan ciri-ciri sistem yang diidamkan pengguna.</p>
        </div>

        <form id="needsSurveyForm" onsubmit="submitNeedsSurvey(event)" class="p-6 md:p-10 space-y-10">

            <div class="space-y-4 bg-slate-50 p-6 rounded-xl border border-slate-200">
                <div class="flex items-center gap-2 mb-2">
                    <span class="section-badge">PROFIL</span>
                    <h3 class="text-lg font-bold text-slate-800">Maklumat Responden</h3>
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Nama Penuh</label>
                    <input type="text" id="p_name" class="w-full p-3 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none" required placeholder="Nama Anda">
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-2">Jantina</label>
                        <div class="grid grid-cols-2 gap-2">
                            <label class="cursor-pointer">
                                <input type="radio" name="p_gender" value="Lelaki" class="sr-only" required>
                                <div class="choice-label justify-center font-semibold text-sm">Lelaki</div>
                            </label>
                            <label class="cursor-pointer">
                                <input type="radio" name="p_gender" value="Perempuan" class="sr-only">
                                <div class="choice-label justify-center font-semibold text-sm">Perempuan</div>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-2">Julat Umur</label>
                        <div class="grid grid-cols-2 gap-2">
                            <label class="cursor-pointer">
                                <input type="radio" name="p_age" value="20-29" class="sr-only" required>
                                <div class="choice-label justify-center text-xs font-bold">20 - 29 Tahun</div>
                            </label>
                            <label class="cursor-pointer">
                                <input type="radio" name="p_age" value="30-39" class="sr-only">
                                <div class="choice-label justify-center text-xs font-bold">30 - 39 Tahun</div>
                            </label>
                            <label class="cursor-pointer">
                                <input type="radio" name="p_age" value="40-49" class="sr-only">
                                <div class="choice-label justify-center text-xs font-bold">40 - 49 Tahun</div>
                            </label>
                            <label class="cursor-pointer">
                                <input type="radio" name="p_age" value="50+" class="sr-only">
                                <div class="choice-label justify-center text-xs font-bold">50 Tahun ke atas</div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <hr class="border-slate-200">

            <div class="space-y-6">
                <div class="flex items-center gap-2">
                    <span class="section-badge bg-blue-600">BAHAGIAN A</span>
                    <h3 class="text-lg font-bold text-slate-800">Kaedah Semasa</h3>
                </div>

                <div>
                    <label class="block text-sm font-bold text-slate-800 mb-3">1. Kaedah yang biasa digunakan untuk kehadiran? (Pilih semua yang berkenaan)</label>
                    <div class="grid grid-cols-1 gap-2">
                        <label class="relative"><input type="checkbox" name="q1" value="Google Form (Awal)" class="sr-only"><div class="choice-label"><span class="w-5 h-5 border rounded mr-3 flex items-center justify-center icon-check opacity-0 text-blue-600">âœ“</span>Google Form (Pengesahan Awal)</div></label>
                        <label class="relative"><input type="checkbox" name="q1" value="Google Form (Hadir)" class="sr-only"><div class="choice-label"><span class="w-5 h-5 border rounded mr-3 flex items-center justify-center icon-check opacity-0 text-blue-600">âœ“</span>Google Form (Kehadiran Sebenar)</div></label>
                        <label class="relative"><input type="checkbox" name="q1" value="Manual Kertas" class="sr-only"><div class="choice-label"><span class="w-5 h-5 border rounded mr-3 flex items-center justify-center icon-check opacity-0 text-blue-600">âœ“</span>Senarai Tandatangan Manual (Kertas)</div></label>
                        <label class="relative"><input type="checkbox" name="q1" value="WhatsApp" class="sr-only"><div class="choice-label"><span class="w-5 h-5 border rounded mr-3 flex items-center justify-center icon-check opacity-0 text-blue-600">âœ“</span>WhatsApp / Mesej</div></label>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-bold text-slate-800 mb-3">2. Jika guna Kertas Manual, apa masalahnya?</label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                        <label class="relative"><input type="checkbox" name="q2" value="Tulisan Buruk" class="sr-only"><div class="choice-label text-sm">Tulisan sukar dibaca</div></label>
                        <label class="relative"><input type="checkbox" name="q2" value="Nama Tak Lengkap" class="sr-only"><div class="choice-label text-sm">Nama tidak lengkap</div></label>
                        <label class="relative"><input type="checkbox" name="q2" value="Senarai Hilang" class="sr-only"><div class="choice-label text-sm">Senarai hilang/tercicir</div></label>
                        <label class="relative"><input type="checkbox" name="q2" value="Data Entry" class="sr-only"><div class="choice-label text-sm">Perlu taip semula (Data Entry)</div></label>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-bold text-slate-800 mb-3">3. Jika guna Google Form, apa cabarannya?</label>
                    <div class="grid grid-cols-1 gap-2">
                        <label class="relative"><input type="checkbox" name="q3" value="Kerja Berulang" class="sr-only"><div class="choice-label text-sm">Perlu bina 2 borang & 2 QR berasingan</div></label>
                        <label class="relative"><input type="checkbox" name="q3" value="Peserta Keliru" class="sr-only"><div class="choice-label text-sm">Peserta keliru pautan borang</div></label>
                        <label class="relative"><input type="checkbox" name="q3" value="Analisis Manual" class="sr-only"><div class="choice-label text-sm">Data perlu digabung manual (Excel)</div></label>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-bold text-slate-800 mb-3">4. Adakah proses ini perlu diulang SETIAP kali program?</label>
                    <div class="flex gap-4">
                        <label class="relative flex-1"><input type="radio" name="q4" value="Ya" class="sr-only"><div class="choice-label justify-center font-bold">Ya, Setiap Kali</div></label>
                        <label class="relative flex-1"><input type="radio" name="q4" value="Tidak" class="sr-only"><div class="choice-label justify-center font-bold">Tidak</div></label>
                    </div>
                </div>
            </div>

            <hr class="border-slate-200">

            <div class="space-y-6">
                <div class="flex items-center gap-2">
                    <span class="section-badge bg-indigo-600">BAHAGIAN B</span>
                    <h3 class="text-lg font-bold text-slate-800">Masa & Beban Kerja</h3>
                </div>

                <div>
                    <label class="block text-sm font-bold text-slate-800 mb-3">5. Anggaran masa SETUP sistem (Bina borang, QR, Link)?</label>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                        <label><input type="radio" name="q5" value="5-10m" class="sr-only"><div class="choice-label justify-center text-sm">5-10 minit</div></label>
                        <label><input type="radio" name="q5" value="10-20m" class="sr-only"><div class="choice-label justify-center text-sm">10-20 minit</div></label>
                        <label><input type="radio" name="q5" value="20-30m" class="sr-only"><div class="choice-label justify-center text-sm">20-30 minit</div></label>
                        <label><input type="radio" name="q5" value="30-60m" class="sr-only"><div class="choice-label justify-center text-sm">30-60 minit</div></label>
                        <label><input type="radio" name="q5" value=">1h" class="sr-only"><div class="choice-label justify-center text-sm">> 1 Jam</div></label>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-bold text-slate-800 mb-3">6. Anggaran masa KEY-IN semula data manual ke komputer?</label>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                        <label><input type="radio" name="q6" value="0" class="sr-only"><div class="choice-label justify-center text-sm">Tiada (Auto)</div></label>
                        <label><input type="radio" name="q6" value="10-20m" class="sr-only"><div class="choice-label justify-center text-sm">10-20 minit</div></label>
                        <label><input type="radio" name="q6" value=">30m" class="sr-only"><div class="choice-label justify-center text-sm">> 30 minit</div></label>
                    </div>
                </div>

                <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                    <label class="block text-sm font-bold text-slate-800 mb-3">7. Cara anda menyemak sekolah mana yang hadir?</label>
                    <div class="grid grid-cols-1 gap-2 mb-4">
                        <label><input type="radio" name="q7" value="Manual Excel" class="sr-only"><div class="choice-label text-sm">Semak satu-satu dalam Excel/Kertas</div></label>
                        <label><input type="radio" name="q7" value="Tanya" class="sr-only"><div class="choice-label text-sm">Tanya orang lain</div></label>
                        <label><input type="radio" name="q7" value="Tiada" class="sr-only"><div class="choice-label text-sm">Tidak buat semakan terperinci</div></label>
                    </div>

                    <label class="block text-sm font-bold text-slate-800 mb-3">8. Berapa lama masa diambil untuk semakan ini?</label>
                    <div class="flex gap-2">
                        <label class="flex-1"><input type="radio" name="q8" value="<5m" class="sr-only"><div class="choice-label justify-center text-xs font-bold">< 5 Min</div></label>
                        <label class="flex-1"><input type="radio" name="q8" value="10-30m" class="sr-only"><div class="choice-label justify-center text-xs font-bold">10-30 Min</div></label>
                        <label class="flex-1"><input type="radio" name="q8" value=">30m" class="sr-only"><div class="choice-label justify-center text-xs font-bold">> 30 Min</div></label>
                    </div>
                </div>

                <div class="space-y-6 pt-4">
                    <div class="scale-box">
                        <p class="text-sm font-bold mb-2">9. Tahap BEBAN KERJA mengurus kehadiran cara lama (1 Ringan - 5 Berat):</p>
                        <div class="flex justify-between gap-1">
                            <script>for(let i=1;i<=5;i++) document.write(`<div class="flex-1"><input type="radio" name="q11" id="q11_${i}" value="${i}" class="hidden"><label for="q11_${i}" class="block text-center py-3 border border-slate-300 rounded font-bold hover:bg-slate-50 transition">${i}</label></div>`)</script>
                        </div>
                    </div>

                    <div class="scale-box">
                        <p class="text-sm font-bold mb-2">10. Tahap KESUKARAN memantau status sekolah (1 Mudah - 5 Sukar):</p>
                        <div class="flex justify-between gap-1">
                            <script>for(let i=1;i<=5;i++) document.write(`<div class="flex-1"><input type="radio" name="q12" id="q12_${i}" value="${i}" class="hidden"><label for="q12_${i}" class="block text-center py-3 border border-slate-300 rounded font-bold hover:bg-slate-50 transition">${i}</label></div>`)</script>
                        </div>
                    </div>
                    
                    <div>
                        <p class="text-sm font-bold mb-2">11. Secara keseluruhan, sistem sedia ada adalah:</p>
                        <div class="grid grid-cols-2 gap-2">
                            <label><input type="radio" name="q13" value="Efisien" class="sr-only"><div class="choice-label justify-center text-sm font-bold">Efisien</div></label>
                            <label><input type="radio" name="q13" value="Sederhana" class="sr-only"><div class="choice-label justify-center text-sm font-bold">Sederhana</div></label>
                            <label><input type="radio" name="q13" value="Kurang Efisien" class="sr-only"><div class="choice-label justify-center text-sm font-bold">Kurang Efisien</div></label>
                            <label><input type="radio" name="q13" value="Tidak Efisien" class="sr-only"><div class="choice-label justify-center text-sm font-bold text-red-600">Tidak Efisien</div></label>
                        </div>
                    </div>
                </div>
            </div>

            <hr class="border-slate-200">

            <div class="bg-indigo-50 p-6 rounded-xl border border-indigo-100">
                <div class="flex items-center gap-2 mb-4">
                    <span class="section-badge bg-indigo-800">BAHAGIAN C</span>
                    <h3 class="text-lg font-bold text-indigo-900">Solusi Bersepadu</h3>
                </div>
                
                <div class="bg-white p-4 rounded-lg border border-indigo-200 mb-6 shadow-sm">
                    <p class="text-sm text-gray-700 font-medium mb-2">Bayangkan satu sistem (SPARK) yang boleh:</p>
                    <ul class="text-xs text-gray-600 space-y-1 list-disc list-inside">
                        <li>Gabung pengesahan & kehadiran dalam 1 platform.</li>
                        <li>QR Code auto-jana & data berpusat (tiada ralat).</li>
                        <li>Laporan kehadiran sekolah secara <b>Real-Time</b>.</li>
                    </ul>
                </div>

                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-bold text-slate-800 mb-3">12. Adakah sistem seperti ini DIPERLUKAN?</label>
                        <div class="flex gap-2">
                             <label class="flex-1"><input type="radio" name="q14" value="Ya" class="sr-only"><div class="choice-label justify-center font-bold text-indigo-700">YA, Sangat Perlu</div></label>
                             <label class="flex-1"><input type="radio" name="q14" value="Tidak" class="sr-only"><div class="choice-label justify-center text-sm">Tidak Perlu</div></label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-800 mb-3">13. Adakah ia akan mengurangkan beban kerja anda?</label>
                         <div class="flex gap-2">
                             <label class="flex-1"><input type="radio" name="q15" value="Ya" class="sr-only"><div class="choice-label justify-center font-bold text-green-700">Sangat Membantu</div></label>
                             <label class="flex-1"><input type="radio" name="q15" value="Mungkin" class="sr-only"><div class="choice-label justify-center text-sm">Mungkin</div></label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-800 mb-3">14. Jika sistem ini wujud, adakah anda bersedia menggunakannya?</label>
                        <label class="relative block">
                            <input type="radio" name="q16" value="Ya" class="sr-only" required>
                            <div class="choice-label justify-center font-extrabold text-white bg-slate-800 hover:bg-slate-900 border-none shadow-lg py-4">
                                YA, SAYA SOKONG! ðŸš€
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <div class="bg-purple-50 p-6 rounded-xl border border-purple-100">
                <div class="flex items-center gap-2 mb-4">
                    <span class="section-badge bg-purple-700">BAHAGIAN D</span>
                    <h3 class="text-lg font-bold text-purple-900">Ciri-Ciri Idaman</h3>
                </div>
                
                <label class="block text-sm font-bold text-slate-800 mb-3">15. Apakah ciri yang WAJIB ada dalam sistem baharu ini? (Pilih semua)</label>
                <div class="grid grid-cols-1 gap-2 mb-4">
                    <label class="relative"><input type="checkbox" name="q17" value="Muat Turun Excel" class="sr-only"><div class="choice-label"><span class="w-5 h-5 border rounded mr-3 flex items-center justify-center icon-check opacity-0 text-purple-600">âœ“</span>Boleh muat turun maklumat (Excel)</div></label>
                    <label class="relative"><input type="checkbox" name="q17" value="OPR" class="sr-only"><div class="choice-label"><span class="w-5 h-5 border rounded mr-3 flex items-center justify-center icon-check opacity-0 text-purple-600">âœ“</span>Ada OPR (Laporan Automatik)</div></label>
                    <label class="relative"><input type="checkbox" name="q17" value="Takwim" class="sr-only"><div class="choice-label"><span class="w-5 h-5 border rounded mr-3 flex items-center justify-center icon-check opacity-0 text-purple-600">âœ“</span>Takwim / Kalendar Aktiviti</div></label>
                    <label class="relative"><input type="checkbox" name="q17" value="Sijil" class="sr-only"><div class="choice-label"><span class="w-5 h-5 border rounded mr-3 flex items-center justify-center icon-check opacity-0 text-purple-600">âœ“</span>Kemudahan Sijil Digital</div></label>
                    <label class="relative"><input type="checkbox" name="q17" value="Semua Di Atas" class="sr-only"><div class="choice-label font-bold text-purple-800"><span class="w-5 h-5 border rounded mr-3 flex items-center justify-center icon-check opacity-0 text-purple-600">âœ“</span>SEMUA DI ATAS</div></label>
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Cadangan Lain:</label>
                    <textarea id="other_suggestions" class="w-full p-3 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 outline-none" placeholder="Apa lagi yang anda mahukan?"></textarea>
                </div>
            </div>

            <button type="submit" id="btnSubmit" class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg hover:bg-blue-700 transition transform active:scale-[0.99] uppercase tracking-wider text-sm">
                HANTAR MAKLUM BALAS
            </button>

        </form>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAEBe1XF7cqaxkTNBZBoo3DBJYIuchOEkM",
            authDomain: "myqrhadir.firebaseapp.com",
            projectId: "myqrhadir",
            storageBucket: "myqrhadir.appspot.com",
            messagingSenderId: "799691133747",
            appId: "1:799691133747:web:835a5e3e9413eace806446"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Helper Functions
        const getVal = (name) => {
            const el = document.querySelector(`input[name="${name}"]:checked`);
            return el ? el.value : '';
        };
        const getMultiVal = (name) => {
            const els = document.querySelectorAll(`input[name="${name}"]:checked`);
            return Array.from(els).map(e => e.value);
        };
        const getSelectVal = (name) => {
             // For select elements if used, currently we use radios mostly
             const el = document.querySelector(`select[name="${name}"]`);
             return el ? el.value : '';
        };

        window.submitNeedsSurvey = async function(e) {
            e.preventDefault();
            const btn = document.getElementById('btnSubmit');
            btn.textContent = "SEDANG MENGHANTAR...";
            btn.disabled = true;

            const data = {
                // Profil
                name: document.getElementById('p_name').value,
                gender: getVal('p_gender'),
                ageGroup: getVal('p_age'),

                // Part A
                methods: getMultiVal('q1'),
                manualIssues: getMultiVal('q2'),
                gformIssues: getMultiVal('q3'),
                repetition: getVal('q4'),
                
                // Part B
                setupTime: getVal('q5'),
                dataEntryTime: getVal('q6'),
                checkMethod: getVal('q7'),
                checkTime: getVal('q8'),
                // Q9 & Q10 omitted based on revised flow, now mapped to scale
                burdenScale: getVal('q11'),
                difficultyScale: getVal('q12'),
                efficiency: getVal('q13'),
                
                // Part C
                needAgreement: getVal('q14'),
                workloadHelp: getVal('q15'),
                willingness: getVal('q16'),

                // Part D (New)
                wishlist: getMultiVal('q17'),
                otherSuggestions: document.getElementById('other_suggestions').value,

                timestamp: serverTimestamp()
            };

            try {
                // Simpan ke koleksi berasingan untuk kajian keperluan
                await addDoc(collection(db, "spark_needs_survey"), data);
                alert("Terima kasih! Data ini sangat penting untuk menyokong pembangunan sistem.");
                // Redirect ke halaman pengenalan atau utama
                window.location.href = 'index.html'; 
            } catch (error) {
                console.error("Error:", error);
                alert("Gagal menghantar data.");
                btn.textContent = "CUBA LAGI";
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
