<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaji Selidik Impak SPARK</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f8fafc; }
        .form-radio { @apply w-4 h-4 text-teal-600 border-gray-300 focus:ring-teal-500; }
        .section-title { @apply text-sm font-bold text-gray-800 uppercase tracking-wider mb-4 border-b border-gray-200 pb-2; }
    </style>
</head>
<body class="text-gray-800 min-h-screen flex items-center justify-center py-10 px-4">

    <div class="max-w-2xl w-full bg-white shadow-xl rounded-2xl overflow-hidden">
        
        <div class="bg-gradient-to-r from-teal-600 to-teal-800 p-8 text-center text-white">
            <h1 class="text-3xl font-extrabold uppercase tracking-widest">Suara Pengguna SPARK</h1>
            <p class="text-teal-100 text-sm mt-2 max-w-md mx-auto">Bantu kami membuktikan impak inovasi ini melalui pengalaman sebenar anda berbanding kaedah konvensional.</p>
        </div>

        <form id="surveyForm" onsubmit="submitSurvey(event)" class="p-8 space-y-8">

            <div>
                <h3 class="section-title">A. Profil Pengguna</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Nama Penuh (Pilihan)</label>
                        <input type="text" id="name" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 outline-none text-sm" placeholder="Nama Anda">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Jantina</label>
                        <div class="flex gap-4 mt-2">
                            <label class="flex items-center gap-2 cursor-pointer bg-gray-50 px-4 py-2 rounded-lg border hover:border-teal-300 transition w-full justify-center">
                                <input type="radio" name="gender" value="Lelaki" class="form-radio" required>
                                <span class="text-sm">Lelaki</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer bg-gray-50 px-4 py-2 rounded-lg border hover:border-teal-300 transition w-full justify-center">
                                <input type="radio" name="gender" value="Perempuan" class="form-radio">
                                <span class="text-sm">Perempuan</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-blue-50 p-6 rounded-xl border border-blue-100">
                <h3 class="text-sm font-bold text-blue-900 uppercase mb-4 flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    B. Analisis Masa (Anggaran Jujur)
                </h3>
                
                <div class="space-y-6">
                    <div>
                        <label class="block text-xs font-bold text-gray-600 mb-2">1. Berapa lama masa anda ambil untuk mendaftar secara MANUAL (tulis tangan/cari nama dalam senarai kertas)?</label>
                        <select id="timeManual" class="w-full p-2 text-sm border rounded-lg bg-white" required>
                            <option value="30">30 Saat (Cepat)</option>
                            <option value="60">1 Minit (Sederhana)</option>
                            <option value="120">2 Minit (Lambat/Beratur)</option>
                            <option value="300">5 Minit+ (Cari fail hilang)</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-gray-600 mb-2">2. Berapa lama masa anda ambil untuk mendaftar menggunakan SPARK (Scan QR)?</label>
                        <select id="timeSpark" class="w-full p-2 text-sm border rounded-lg bg-white" required>
                            <option value="3">3 Saat (Sangat Pantas)</option>
                            <option value="5">5 Saat (Pantas)</option>
                            <option value="10">10 Saat (Sederhana)</option>
                            <option value="30">30 Saat (Masalah Internet)</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-gray-600 mb-2">3. Jika anda penganjur, berapa lama masa diambil untuk sediakan laporan kehadiran (Analisis Data) secara MANUAL?</label>
                        <select id="timeReportManual" class="w-full p-2 text-sm border rounded-lg bg-white" required>
                            <option value="60">1 Jam</option>
                            <option value="180">3 Jam</option>
                            <option value="300">5 Jam</option>
                            <option value="1440">1 Hari atau Lebih</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-gray-600 mb-2">4. Berapa lama masa SPARK ambil untuk jana laporan lengkap (OPR)?</label>
                        <select id="timeReportSpark" class="w-full p-2 text-sm border rounded-lg bg-white" required>
                            <option value="0">Serta-merta (Real-time)</option>
                            <option value="1">1 Minit</option>
                            <option value="5">5 Minit</option>
                        </select>
                    </div>
                </div>
            </div>

            <div>
                <h3 class="section-title">C. Beban Kerja & Integriti Data</h3>
                <div class="space-y-4 text-sm">
                    
                    <div>
                        <p class="font-medium mb-2">5. Adakah anda merasa terbeban perlu mengisi DUA borang (Google Form Tinjauan + Google Form Kehadiran) sebelum ini?</p>
                        <div class="flex gap-4">
                            <label><input type="radio" name="q5" value="Ya" class="form-radio" required> Ya, Sangat Beban</label>
                            <label><input type="radio" name="q5" value="Tidak" class="form-radio"> Tidak</label>
                        </div>
                    </div>

                    <div>
                        <p class="font-medium mb-2">6. Dengan SPARK, adakah proses "Sekali Daftar, Terus Guna" (Single Sign-On) memudahkan anda?</p>
                        <div class="flex gap-4">
                            <label><input type="radio" name="q6" value="Ya" class="form-radio" required> Ya, Sangat Mudah</label>
                            <label><input type="radio" name="q6" value="Biasa" class="form-radio"> Biasa Sahaja</label>
                        </div>
                    </div>

                    <div>
                        <p class="font-medium mb-2">7. Pernahkah anda tersalah isi nama/IC/sekolah dalam Google Form atau kertas sebelum ini?</p>
                        <div class="flex gap-4">
                            <label><input type="radio" name="q7" value="Ya" class="form-radio" required> Ya, Pernah</label>
                            <label><input type="radio" name="q7" value="Tidak" class="form-radio"> Tidak Pernah</label>
                        </div>
                    </div>

                    <div>
                        <p class="font-medium mb-2">8. Adakah anda yakin data dalam SPARK lebih tepat kerana ia dijana dari pangkalan data (tiada typo)?</p>
                        <div class="flex gap-4">
                            <label><input type="radio" name="q8" value="Ya" class="form-radio" required> Ya, Lebih Tepat</label>
                            <label><input type="radio" name="q8" value="Ragu" class="form-radio"> Masih Ragu</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-gray-50 p-6 rounded-xl border border-gray-200">
                <h3 class="text-sm font-bold text-gray-800 uppercase mb-4">D. Penilaian Fitur SPARK</h3>
                <div class="space-y-4">
                    
                    <div class="flex justify-between items-center">
                        <label class="text-xs font-medium w-2/3">9. Ciri OPR (One Page Report) automatik sangat membantu tugas pelaporan.</label>
                        <select name="q9" class="text-xs border rounded p-1" required>
                            <option value="5">Sangat Setuju</option>
                            <option value="4">Setuju</option>
                            <option value="3">Neutral</option>
                        </select>
                    </div>

                    <div class="flex justify-between items-center">
                        <label class="text-xs font-medium w-2/3">10. Kemudahan memuat turun Sijil Digital terus dari sistem.</label>
                        <select name="q10" class="text-xs border rounded p-1" required>
                            <option value="5">Sangat Membantu</option>
                            <option value="4">Membantu</option>
                            <option value="3">Kurang Guna</option>
                        </select>
                    </div>

                    <div class="flex justify-between items-center">
                        <label class="text-xs font-medium w-2/3">11. Paparan Dashboard Analisis (Graf) membantu melihat trend kehadiran.</label>
                        <select name="q11" class="text-xs border rounded p-1" required>
                            <option value="5">Sangat Berguna</option>
                            <option value="4">Berguna</option>
                            <option value="3">Jarang Lihat</option>
                        </select>
                    </div>

                    <div class="flex justify-between items-center">
                        <label class="text-xs font-medium w-2/3">12. Sistem SPARK mesra pengguna (User Friendly) walaupun untuk orang yang kurang mahir IT.</label>
                        <select name="q12" class="text-xs border rounded p-1" required>
                            <option value="5">Sangat Mesra</option>
                            <option value="4">Boleh Tahan</option>
                            <option value="3">Agak Sukar</option>
                        </select>
                    </div>
                </div>
            </div>

            <div>
                <h3 class="section-title">E. Rumusan Impak</h3>
                <div class="space-y-5 text-sm">

                    <div>
                        <p class="font-medium mb-2">13. Pada skala 1-10, sejauh mana SPARK mempercepatkan urusan harian anda?</p>
                        <input type="range" name="q13" min="1" max="10" value="8" class="w-full h-2 bg-teal-200 rounded-lg appearance-none cursor-pointer">
                        <div class="flex justify-between text-[10px] text-gray-500 mt-1"><span>1 (Tiada Beza)</span><span>10 (Sangat Pantas)</span></div>
                    </div>

                    <div>
                        <p class="font-medium mb-2">14. Adakah anda menyokong jika SPARK dijadikan sistem rasmi tunggal (menghapuskan kertas sepenuhnya)?</p>
                        <div class="flex gap-4">
                            <label><input type="radio" name="q14" value="Ya" class="form-radio" required> Ya, Sokong 100%</label>
                            <label><input type="radio" name="q14" value="Mungkin" class="form-radio"> Perlu Masa</label>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs font-bold text-gray-500 mb-1">15. Satu perkataan untuk SPARK?</label>
                            <input type="text" name="q15" class="w-full border rounded p-2 text-sm" placeholder="Contoh: Efisien" required>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-500 mb-1">16. Masalah utama cara lama?</label>
                            <input type="text" name="q16" class="w-full border rounded p-2 text-sm" placeholder="Contoh: Kertas hilang" required>
                        </div>
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">17. Bagaimana SPARK menjimatkan kos anda/pejabat? (Cth: Kertas, Ink, Masa)</label>
                        <input type="text" name="q17" class="w-full border rounded p-2 text-sm" placeholder="Nyatakan..." required>
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">18. Cadangan penambahbaikan untuk masa depan?</label>
                        <textarea name="q18" rows="2" class="w-full border rounded p-2 text-sm" placeholder="..."></textarea>
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1">19. Testimoni/Komen Padu untuk Juri (Wajib)</label>
                        <textarea id="comment" rows="3" class="w-full border rounded p-2 text-sm bg-teal-50 border-teal-200 focus:ring-teal-500" placeholder="Contoh: SPARK mengubah cara kerja kami menjadi lebih sistematik dan pantas..." required></textarea>
                    </div>

                    <div>
                        <p class="font-medium mb-2">20. Adakah anda bersetuju data ini digunakan untuk tujuan kajian inovasi?</p>
                        <label class="flex items-center gap-2"><input type="checkbox" required class="form-checkbox text-teal-600"> Saya Bersetuju</label>
                    </div>

                </div>
            </div>

            <button type="submit" id="btnSubmit" class="w-full bg-teal-600 text-white font-bold py-4 rounded-xl shadow-lg hover:bg-teal-700 transition transform active:scale-95 uppercase tracking-wide text-sm">
                HANTAR MAKLUM BALAS & SUMBANG DATA
            </button>

        </form>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAEBe1XF7cqaxkTNBZBoo3DBJYIuchOEkM",
            authDomain: "myqrhadir.firebaseapp.com",
            projectId: "myqrhadir",
            storageBucket: "myqrhadir.appspot.com",
            messagingSenderId: "799691133747",
            appId: "1:799691133747:web:835a5e3e9413eace806446"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.submitSurvey = async function(e) {
            e.preventDefault();
            const btn = document.getElementById('btnSubmit');
            btn.textContent = "SEDANG MENGHANTAR DATA...";
            btn.disabled = true;

            // Kumpul Data Form
            const formData = new FormData(document.getElementById('surveyForm'));
            const data = {};
            
            // Auto map form entries to object
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }

            // Manual mapping for specific IDs if needed
            data.name = document.getElementById('name').value || "Tanpa Nama";
            data.timeManual = parseInt(document.getElementById('timeManual').value);
            data.timeSpark = parseInt(document.getElementById('timeSpark').value);
            data.timeReportManual = parseInt(document.getElementById('timeReportManual').value);
            data.timeReportSpark = parseInt(document.getElementById('timeReportSpark').value);
            data.comment = document.getElementById('comment').value;
            data.timestamp = serverTimestamp();

            // Calculate Time Saved (Untuk analisis segera)
            data.timeSavedRegistration = data.timeManual - data.timeSpark;
            data.timeSavedReporting = data.timeReportManual - data.timeReportSpark;

            try {
                await addDoc(collection(db, "spark_feedback_v2"), data); // Guna koleksi baru v2
                alert("Terima kasih! Data anda telah direkodkan untuk analisis inovasi.");
                window.location.reload();
            } catch (error) {
                console.error("Error:", error);
                alert("Ralat sambungan. Sila cuba lagi.");
                btn.textContent = "CUBA LAGI";
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
