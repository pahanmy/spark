// --- Fungsi Bantuan (Helper) ---

function kiraBakiHari(tarikhString, peratus) {
    // KEMAS KINI: Jika peratus adalah 100, ia sentiasa Selesai, ABAIKAN baki hari.
    if (peratus == 100) {
        return { teks: 'Selesai', badgeClass: 'bg-green-100 text-green-800' };
    }
    
    // Logik sedia ada untuk selain 100%
    const tarikhSiap = new Date(tarikhString);
    if (isNaN(tarikhSiap.getTime())) {
        return { teks: '-', badgeClass: 'bg-gray-100 text-gray-800' };
    }
    const hariIni = new Date();
    hariIni.setHours(0, 0, 0, 0);
    const tarikhSiapTengahMalam = new Date(tarikhString);
    tarikhSiapTengahMalam.setHours(0, 0, 0, 0);
    const bezaMasa = tarikhSiapTengahMalam.getTime() - hariIni.getTime();
    const bezaHari = Math.ceil(bezaMasa / (1000 * 60 * 60 * 24));
    
    if (bezaHari > 0) {
        return { teks: `${bezaHari} hari lagi`, badgeClass: 'bg-indigo-100 text-indigo-800' };
    } else if (bezaHari === 0) {
        return { teks: 'Hari Ini', badgeClass: 'bg-amber-100 text-amber-800' };
    } else {
        // Hanya tunjuk "Terlewat" jika ia BUKAN 100%
        return { teks: `Terlewat ${Math.abs(bezaHari)} hari`, badgeClass: 'bg-red-100 text-red-800' };
    }
}
