<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPARK â€“ Minit Curai Digital</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Noto+Serif:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Poppins', sans-serif; background-color: #f0fdfa; } /* Teal-50 background */
        
        /* A4 Paper Styling */
        #pdf-wrapper { width: 210mm; margin: 0 auto; background: white; }
        .a4-paper {
            width: 210mm; min-height: 297mm; 
            padding: 20mm 20mm;
            background: white; box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            color: black; position: relative;
            font-family: 'Arial', sans-serif; /* Minit usually uses Arial/Times */
        }

        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #0d9488; border-radius: 3px; }

        /* Form Elements */
        .input-group { margin-bottom: 1rem; }
        .input-label { display: block; font-size: 0.7rem; font-weight: 700; color: #4b5563; text-transform: uppercase; margin-bottom: 0.25rem; }
        .spark-input { width: 100%; font-size: 0.85rem; border: 1px solid #cbd5e1; border-radius: 0.5rem; padding: 0.5rem; transition: all 0.2s; }
        .spark-input:focus { outline: none; border-color: #0d9488; ring: 2px solid #ccfbf1; }

        /* Preview Table Styles */
        .minit-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .minit-table th, .minit-table td { border: 1px solid #000; padding: 8px; vertical-align: top; }
        .minit-header { background-color: #f0fdf4; font-weight: bold; }
        
        .poin-item { display: flex; gap: 2; margin-bottom: 5px; }
        
        @media print {
            body { background: white; }
            .no-print { display: none !important; }
            .a4-paper { box-shadow: none; margin: 0; }
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden text-gray-800">

    <header class="bg-white shadow-sm border-b border-gray-200 z-50 no-print flex-shrink-0">
        <div class="w-full px-6 py-3 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="bg-teal-600 p-2 rounded-lg shadow-md">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-teal-700 uppercase tracking-wide flex items-center gap-2">
                        SPARK MINIT
                        <span class="text-[10px] bg-teal-50 text-teal-600 px-2 py-0.5 rounded border border-teal-200 font-bold uppercase tracking-wider">PRO</span>
                    </h1>
                    <p class="text-xs text-gray-500">Penjana Minit Curai & Nota Mesyuarat</p>
                </div>
            </div>
            
            <div class="flex items-center gap-2">
                <button onclick="window.location.href='user.html'" class="text-gray-500 hover:text-teal-600 text-sm font-semibold px-3 flex items-center gap-1 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                    Kembali
                </button>
                <div class="h-6 w-px bg-gray-300 mx-1"></div>
                
                <button onclick="downloadPDF()" class="bg-teal-600 hover:bg-teal-700 text-white text-xs font-bold py-2 px-5 rounded-lg shadow-md flex items-center gap-2 uppercase transition-transform hover:scale-105">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                    Muat Turun PDF
                </button>
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        
        <div class="w-full lg:w-1/3 bg-white border-r border-gray-200 overflow-y-auto p-6 no-print z-10 custom-scrollbar">
            
            <div class="mb-6 flex gap-2">
                <button onclick="loadDemoData()" class="w-full bg-indigo-50 text-indigo-700 border border-indigo-200 py-2 rounded text-xs font-bold uppercase hover:bg-indigo-100 transition">
                    ðŸ”„ Reset / Muat Data Asal
                </button>
            </div>

            <form id="minit-form" oninput="updatePreview()">
                
                <div class="bg-gray-50 p-4 rounded-xl border border-gray-200 mb-4">
                    <h3 class="text-xs font-bold text-gray-500 uppercase mb-3 border-b border-gray-200 pb-2">Maklumat Mesyuarat</h3>
                    
                    <div class="input-group">
                        <label class="input-label">Tajuk Mesyuarat / Program</label>
                        <textarea id="in-tajuk" rows="2" class="spark-input font-bold uppercase" placeholder="Tajuk Mesyuarat..."></textarea>
                    </div>

                    <div class="grid grid-cols-2 gap-3">
                        <div class="input-group">
                            <label class="input-label">Tarikh</label>
                            <input type="text" id="in-tarikh" class="spark-input" placeholder="Contoh: 29 Januari 2026">
                        </div>
                        <div class="input-group">
                            <label class="input-label">Masa</label>
                            <input type="text" id="in-masa" class="spark-input" placeholder="Contoh: 8.30 Pagi">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Tempat / Platform</label>
                        <input type="text" id="in-tempat" class="spark-input" placeholder="Contoh: Google Meet">
                    </div>
                     <div class="input-group">
                        <label class="input-label">Anjuran / Pengerusi</label>
                        <input type="text" id="in-anjuran" class="spark-input" placeholder="Contoh: JPNS">
                    </div>
                </div>

                <div class="bg-white p-1 mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-xs font-bold text-teal-700 uppercase">Kandungan / Coretan</h3>
                        <button type="button" onclick="addPoint()" class="text-[10px] bg-teal-100 text-teal-700 px-2 py-1 rounded font-bold hover:bg-teal-200 transition">+ Tambah Poin</button>
                    </div>
                    
                    <div id="points-container" class="space-y-3">
                        </div>
                </div>

                <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                    <h3 class="text-xs font-bold text-gray-500 uppercase mb-3 border-b border-gray-200 pb-2">Pengesahan</h3>
                    
                    <div class="input-group">
                        <label class="input-label">Disediakan Oleh (Nama)</label>
                        <input type="text" id="in-nama" class="spark-input font-bold uppercase">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Jawatan</label>
                        <input type="text" id="in-jawatan" class="spark-input uppercase">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Tarikh Laporan</label>
                        <input type="text" id="in-tarikh-laporan" class="spark-input">
                    </div>
                </div>

            </form>
        </div>

        <div class="w-full lg:w-2/3 bg-gray-100 overflow-auto flex justify-center p-8 custom-scrollbar">
            <div id="pdf-wrapper">
                <div class="a4-paper transform scale-100 origin-top" id="main-report">
                    
                    <div class="text-center border-b-2 border-black pb-4 mb-6">
                        <h2 class="text-xl font-bold uppercase tracking-wider mb-1 text-black">MINIT CURAI / NOTA MESYUARAT</h2>
                        <h3 id="out-tajuk" class="text-lg font-semibold uppercase text-gray-800 leading-tight">TAJUK MESYUARAT</h3>
                    </div>

                    <table class="minit-table mb-6 text-sm">
                        <tr>
                            <th class="w-1/4 bg-gray-100 text-left uppercase text-xs">Tarikh</th>
                            <td id="out-tarikh" class="w-1/4"></td>
                            <th class="w-1/4 bg-gray-100 text-left uppercase text-xs">Masa</th>
                            <td id="out-masa" class="w-1/4"></td>
                        </tr>
                        <tr>
                            <th class="bg-gray-100 text-left uppercase text-xs">Tempat / Platform</th>
                            <td id="out-tempat" colspan="3"></td>
                        </tr>
                         <tr>
                            <th class="bg-gray-100 text-left uppercase text-xs">Anjuran / Pengerusi</th>
                            <td id="out-anjuran" colspan="3"></td>
                        </tr>
                    </table>

                    <div class="mb-8">
                        <h4 class="text-sm font-bold uppercase border-b border-gray-300 mb-4 pb-1">Intipati / Coretan Mesyuarat</h4>
                        
                        <div id="out-content" class="text-sm text-justify leading-relaxed space-y-4">
                            </div>
                    </div>

                    <div class="mt-auto flex justify-end pt-10">
                        <div class="w-1/3 text-center">
                            <p class="text-xs italic mb-8 text-left">Disediakan oleh:</p>
                            <p id="out-nama" class="font-bold uppercase text-sm border-b border-black inline-block min-w-full text-left pb-1">NAMA PEGAWAI</p>
                            <p id="out-jawatan" class="text-xs uppercase text-left mt-1">JAWATAN</p>
                            <p id="out-tarikh-laporan" class="text-xs text-left mt-1">TARIKH</p>
                        </div>
                    </div>

                    <div class="absolute bottom-4 left-0 w-full text-center">
                        <p class="text-[8px] text-gray-300 uppercase tracking-[0.2em]">Dijana oleh SPARK Minit Curai</p>
                    </div>

                </div>
            </div>
        </div>

    </div>

    <script>
        // Data structure based on the user's uploaded PDF
        const demoData = {
            tajuk: "CORETAN PESANAN PENGARAH JPNS DALAM SLU BERSAMA SEMUA SIPARTNERS+ SARAWAK",
            tarikh: "29 Januari 2026 (Khamis)",
            masa: "8.30 Pagi",
            tempat: "Secara Dalam Talian (Google Meet)",
            anjuran: "Pengarah JPNS",
            nama: "PN. SU YIEN JIONG",
            jawatan: "SIPARTNERS+ PPD MIRI",
            tarikhLaporan: "29 Januari 2026",
            points: [
                "Terima kasih atas kehadiran semua barisan SIPartners+ negeri Sarawak.",
                "Rancangan Pendidikan Malaysia (RPM) 2026-2035: PGB perlu sebarluaskan RPM terkini. Perubahan istilah 'Berkualiti' kepada 'Bermutu' dalam Visi dan Misi KPM.",
                "Isu-isu Sekolah: PGB perlu peka dan uruskan keperluan sekolah dengan sebaik mungkin kerana masyarakat memerhati.",
                "SKKSM: PGB perlu menguasai 9 bidang pengurusan terutamanya kewangan. Belanja berhemah dan patuhi prosedur.",
                "5 Tumpuan Utama RPM 2026-2035: (1) Mutu, (2) Akses & Ekuiti, (3) Ketersediaan Sumber, (4) Keluwesan, (5) Kemampanan.",
                "Pencapaian Akademik Sarawak: Masih tahap membimbangkan. Perlu intervensi berimpak. Data Ujian Tahun 4 perlu dianalisis untuk persediaan ke Tahun 5.",
                "Isu SPM: Justifikasi perlu spesifik. Contoh: 'Kemahiran bertutur BM belum dikuasai', bukan sekadar 'lemah'.",
                "Kepimpinan PGB: Perlu proaktif mencari sumber kewangan (JnJ) seperti Pengetua SMK Agama Miri (Ustaz Fauzi). Tahniah!",
                "Bantuan Awal Persekolahan (BAP): Perlu diuruskan segera walaupun di pedalaman.",
                "Teknologi & AI: Pentadbir dan guru perlu berani mencuba teknologi baharu termasuk AI.",
                "Sasaran Wajib RPM: PGB perlu berusaha meningkatkan mutu dalam 12 perkara sasaran wajib.",
                "Fokus Sekolah: BPSH minta pencalonan 5 SM dan 5 SR setiap daerah untuk fokus peningkatan prestasi.",
                "MBPK & 3M: Murid MBPK perlu capai tahap ditetapkan. Murid Tahap 1 wajib kuasai 3M (Literasi & Numerasi) sebelum ke sekolah menengah.",
                "Prasarana: KPM akan tingkatkan prasarana dan internet sekolah.",
                "Sokongan SIPartners+: Sekolah dengan GPS SPM melebihi 5.50 akan dibantu oleh pasukan SIPartners+ merentasi daerah."
            ]
        };

        let pointCount = 0;

        function init() {
            // Check for URL params or Load Demo
            loadDemoData();
        }

        function loadDemoData() {
            document.getElementById('in-tajuk').value = demoData.tajuk;
            document.getElementById('in-tarikh').value = demoData.tarikh;
            document.getElementById('in-masa').value = demoData.masa;
            document.getElementById('in-tempat').value = demoData.tempat;
            document.getElementById('in-anjuran').value = demoData.anjuran;
            document.getElementById('in-nama').value = demoData.nama;
            document.getElementById('in-jawatan').value = demoData.jawatan;
            document.getElementById('in-tarikh-laporan').value = demoData.tarikhLaporan;

            const container = document.getElementById('points-container');
            container.innerHTML = '';
            pointCount = 0;

            demoData.points.forEach(text => {
                addPoint(text);
            });

            updatePreview();
        }

        function addPoint(textValue = "") {
            pointCount++;
            const container = document.getElementById('points-container');
            
            const div = document.createElement('div');
            div.className = "flex gap-2 items-start animate-fade-in";
            div.id = `point-group-${pointCount}`;
            
            div.innerHTML = `
                <span class="mt-2 text-xs font-bold text-gray-400 w-4 text-center">${pointCount}.</span>
                <textarea id="point-input-${pointCount}" rows="2" class="spark-input text-xs" placeholder="Isi kandungan..." oninput="updatePreview()">${textValue}</textarea>
                <button type="button" onclick="removePoint(${pointCount})" class="mt-1 text-gray-400 hover:text-red-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            `;
            container.appendChild(div);
            updatePreview();
        }

        function removePoint(id) {
            const el = document.getElementById(`point-group-${id}`);
            if(el) el.remove();
            
            // Re-index visually in preview (optional, handled by render)
            updatePreview();
        }

        function updatePreview() {
            // Map inputs to outputs
            document.getElementById('out-tajuk').textContent = document.getElementById('in-tajuk').value || "TAJUK MESYUARAT";
            document.getElementById('out-tarikh').textContent = document.getElementById('in-tarikh').value;
            document.getElementById('out-masa').textContent = document.getElementById('in-masa').value;
            document.getElementById('out-tempat').textContent = document.getElementById('in-tempat').value;
            document.getElementById('out-anjuran').textContent = document.getElementById('in-anjuran').value;
            
            document.getElementById('out-nama').textContent = document.getElementById('in-nama').value || "NAMA PEGAWAI";
            document.getElementById('out-jawatan').textContent = document.getElementById('in-jawatan').value || "JAWATAN";
            document.getElementById('out-tarikh-laporan').textContent = document.getElementById('in-tarikh-laporan').value;

            // Render Points
            const contentDiv = document.getElementById('out-content');
            contentDiv.innerHTML = '';
            
            const pointInputs = document.querySelectorAll('[id^="point-input-"]');
            let displayIndex = 1;

            pointInputs.forEach(input => {
                if(input.value.trim() !== "") {
                    const p = document.createElement('div');
                    p.className = "flex gap-4 items-start";
                    p.innerHTML = `
                        <span class="font-bold min-w-[20px] text-right">${displayIndex}.</span>
                        <p class="whitespace-pre-wrap flex-grow">${input.value}</p>
                    `;
                    contentDiv.appendChild(p);
                    displayIndex++;
                }
            });
        }

        function downloadPDF() {
            const element = document.getElementById('pdf-wrapper');
            const tajuk = document.getElementById('in-tajuk').value.substring(0, 20).replace(/[^a-zA-Z0-9]/g, '_');
            
            const opt = {
                margin: 0,
                filename: `Minit_Curai_${tajuk}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            // Temporary hide placeholder borders/colors if needed
            html2pdf().set(opt).from(element).save();
        }

        // Initialize
        init();

    </script>
</body>
</html>
